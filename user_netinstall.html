<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>User | Open Docs</title>

    <!-- Contrast Favicon -->
    <link rel="icon" href="assets/images/favicon.ico">
    
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">

    <!-- Bootstrap theme -->
    <link href="assets/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <!-- Custom styles for this template -->
    <link href="assets/css/main.css" rel="stylesheet">

    <!-- Lightbox -->
    <link href="assets/css/lightbox/lightbox.css" rel="stylesheet">

    <!-- Google Font: Lato -->
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">


    <!-- ZenDesk Support Widget -->
    <!-- Start of contrastsecurity Zendesk Widget script -->
    <script>/*<![CDATA[*/window.zEmbed||function(e,t){var n,o,d,i,s,a=[],r=document.createElement("iframe");window.zEmbed=function(){a.push(arguments)},window.zE=window.zE||window.zEmbed,r.src="javascript:false",r.title="",r.role="presentation",(r.frameElement||r).style.cssText="display: none",d=document.getElementsByTagName("script"),d=d[d.length-1],d.parentNode.insertBefore(r,d),i=r.contentWindow,s=i.document;try{o=s}catch(c){n=document.domain,r.src='javascript:var d=document.open();d.domain="'+n+'";void(0);',o=s}o.open()._l=function(){var o=this.createElement("script");n&&(this.domain=n),o.id="js-iframe-async",o.src=e,this.t=+new Date,this.zendeskHost=t,this.zEQueue=a,this.body.appendChild(o)},o.write('<body onload="document._l();">'),o.close()}("https://assets.zendesk.com/embeddable_framework/main.js","contrastsecurity.zendesk.com");/*]]>*/</script>

<!-- End of contrastsecurity Zendesk Widget script -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>

    
  <div id="wrapper">

      


<!-- Fixed navbar -->

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">

      <div class="navbar-brand">
          <a href="index.html"><img src="../../assets/images/OpenDocs_logo.png" width="142" height="37" data-toggle="tooltip" data-placement="top" title="Back to OpenDocs Home"></a>
      </div>

  
      <div class="navbar-collapse collapse">
        
          <ul class="nav navbar-nav">
            <li>
              <a href="dev_api3.html">Developer</a>
            </li>
            <li>
              <a href="admin_tsinstall.html">Administrator</a>
            </li>
            <li>
              <a href="user.html">User</a>
            </li>
            <li>
              <a href="release_v3.html">Release Notes</a>
            </li>
            <li>
              <a href="contribute_guidelines.html">Contribute</a>
            </li>
          </ul>
        

        
          <ul class="nav navbar-nav navbar-right">
            <a href="https://github.com/Contrast-Security-OSS/docs" target="new"><i class="fa fa-github fa-2x" data-toggle="tooltip" data-placement="top" title="View the OpenDocs repo on GitHub"></i></a>
          </ul>
      

      </div><!--/.nav-collapse -->
  
</div>






<div id="nav">  

    <div class="persona">
        <img src="../../assets/images/User.png" width="75" height="75">
        <p class="label3">User</p>
    </div>

    <div class="scroll">
        <div class="navitems">
            <ul>
                <li><p class="label5">Agents</p></li>
                <li>Java Agent</li>
                    <li><a href="user_javainstall.html" class="label10">&#8226; Installation</a></li>
                    <li><a href="user_javaconfig.html" class="label10">&#8226; Configuration</a></li>
                    <li><a href="user_javafaq.html" class="label10">&#8226; Troubleshooting</a></li>
                    <br>



                <li>.NET Agent</li>
                    <li class="label10">&#8226; Installation</li>

                        <li><a href="user_netinstall.html#start" class="label9">Getting Started</a></li>
                        <br>

                    <li><a href="user_netconfig.html" class="label10">&#8226; Configuration</a></li>
                    <li><a href="user_netfaq.html" class="label10">&#8226; Troubleshooting</a></li>
                    <br>

<!--
                <li>Node.js Agent</li>
                    <li><a href="user_nodeinstall.html" class="label10">&#8226; Installation</a></li>
                    <li><a href="user_nodeconfig.html" class="label10">&#8226; Configuration</a></li>
                    <li><a href="user_nodefaq.html" class="label10">&#8226; Troubleshooting</a></li>
                <br>
-->

                <br>
                <li><p class="label5">TeamServer</p></li>
                <li>Guide</li>
                    <li><a href="user_tsguideapp.html" class="label10">&#8226; Application</a></li>
                    <li><a href="user_tsguidecrawl.html" class="label10">&#8226; Crawler</a></li>
                    <li><a href="user_tsguidelib.html" class="label10">&#8226; Library</a></li>
                    <li><a href="user_tsguiderep.html" class="label10">&#8226; Report</a></li>
                    <br>

                <li><a href="user_tsfaq.html">Troubleshooting</a></li>
            </ul>
        </div>
    </div>
</div>


<div class="breadcontent">
    <div class="breadcontainer">
        <ol class="breadcrumb">
            <li>User</li>
            <li>Agents</li>
            <li>.NET Agent</li>
            <li class="label6">Installation</li>
        </ol>
    </div>
</div>


<div class="container-content">
    <div class="article">
        <h1 class="label3cat">Getting Started With The .NET Agent</h1>
            <a class="anchor" id="start">
                <div class="actions">
                    <div class="iconbar">
                        
	<a href="https://twitter.com/share" class="twitter-share-button" data-via="contrastsec" data-count="none" data-hashtags="opendocs"></a>
	

<div class="iconbar">

  <a href="https://github.com/Contrast-Security-OSS/docs/issues" target="new"><i class="fa fa-bug fa-lg" data-toggle="tooltip" data-placement="top" title="Report an issue"></i></a>

  <a href="https://github.com/Contrast-Security-OSS/docs/blob/master/content/user/agent/net/install" target="new"><i class="fa fa-pencil fa-lg" data-toggle="tooltip" data-placement="top" title="Improve this article"></i></a>
</div>



                    </div>
                </div>
                <!--
title: "Getting Started with the .Net Agent"
description: "Planning for the Contrast .NET Agent."
-->

<p>There are a few things to take into consideration when you are planning to use Contrast to analyze your ASP.NET web applications. The following information should help you prepare your environment for the Contrast .NET agent.</p>
<h2 id="administrative-access-to-web-server-with-application-s-to-analyze">Administrative Access to Web Server with Application(s) to Analyze</h2>
<p>You&#39;ll need administrative access to the web server in order to install the Contrast .NET Agent. Additionally, the web server should have at least one web application deployed for Contrast to analyze. You&#39;ll also want to make sure that the server and application are supported by Contrast; see <a href="user_netfaq.html#supp">.NET Contrast Agent Supported Technologies</a>. Note that the .NET Contrast Agent requires that the machine have .NET Framework 4.0+ installed.  This requirement does not extend to applications to be analyzed; the .NET Contrast Agent can analyze web applications that run on CLR 2.0 (.NET 2.0/3.0/3.5) or CLR 4 (.NET 4.0+).</p>
<h2 id="contrast-must-be-the-only-profiler">Contrast Must Be the Only Profiler</h2>
<p>The Contrast .NET Agent uses the CLR Profiling API to perform data and code flow analysis (i.e. detect SQL-injection, XSS, weak cryptography, etc.) as well as to detect libraries and technologies in use by the application. The Microsoft CLR has a built-in limitation that only one profiler can profile a process. This limitation comes from Microsoft and their implementation of the CLR.  </p>
<p>From Microsoft&#39;s documentation: <a href="https://msdn.microsoft.com/en-us/library/bb384689(v=vs.110).aspx">https://msdn.microsoft.com/en-us/library/bb384689(v=vs.110).aspx</a>)</p>
<pre><code class="language-bash">Only one profiler can profile a process at one time <span class="keyword">in</span> a given environment. 
You can register two different profilers <span class="keyword">in</span> different environments, but each must profile separate processes.</code></pre>
<h2 id="contrast-must-restart-iis">Contrast Must Restart IIS</h2>
<p>The Profiling API requires that the profiled process be started WITH the profiler therefore the .NET Agent must restart IIS (and any IIS worker processes) in order to attach the Contrast profiler. This is similar to how other profiling products (e.g. memory or performance profilers) behave. Users do not have to restart IIS manually, Contrast will automatically restart IIS when the agent is installed and whenever the .NET Agent is stopped or started. (Note that while the profiling API does offer the ability to attach to an already running process, this feature is only available in specific scenarios and later versions of the CLR.)</p>
<p>You may wish to change configuration of any web server monitoring tools that raise alarms when IIS is restarted. You may also wish to check IIS-dependent services are restarted appropriately when using Contrast. The .NET Agent restarts IIS by stopping the Windows Process Activation Service (WAS) and then starts any previously running services that are dependent on WAS (such as &#39;World Wide Web Publishing Service&#39; (w3svc)). In some cases, users have needed to manually configure service dependencies so that WAS-dependent services were restarted with IIS (e.g. MSMQ Listener Adapter). </p>
<h2 id="install-the-net-agent">Install the .NET Agent</h2>
<p>Once the following has been confirmed:</p>
<ul>
<li>You have administrative access to the web server and the server is supported by Contrast</li>
<li>There is a deployed application to be analyzed and the web application technology is supported by Contrast</li>
<li>The server has at least .NET Framework 4.0 installed</li>
<li>Contrast will be the only profiler present</li>
<li>IIS can be restarted</li>
<li>The web server has network connectivity with TeamServer</li>
</ul>
<p>Then you&#39;re ready to install the Contrast .NET Agent.  Simply log in to the Contrast TeamServer and select <strong>Add an Application</strong>. You can then select the .NET Agent which will download a zip archive file. (Note that you may need to specify proxy authentication information required by your network here before downloading the agent.) Extract the archive on the web server and run <strong><em>ContrastSetup.exe</em></strong>. This will install the .NET Agent. To start analyzing an application, simply point your browser to the web application and use the web application as you normally would: click on links, submit forms using normal data, etc.  The .NET Contrast Agent’s sensors will gather information about the application’s security, architecture, and libraries. The results of the Agent’s analysis can be viewed on Contrast Team Server.</p>
<h2 id="customize-the-configuration-of-the-contrast-net-agent">Customize the Configuration of the Contrast .NET Agent</h2>
<p>You may wish to customize the behavior of the .NET Agent to better suit your needs.</p>
<p><a href="user_netconfig.html#config">Configure Proxy, Performance, Logging, and Analysis</a></p>
<p><a href="user_netconfig.html#pool">Exclude Applications from Analysis</a></p>
<p><a href="user_netconfig.html#servers">Customize the Server Name</a></p>
<p><a href="user_netconfig.html#apps">Customize Application Names</a></p>
<p>Lastly, if you encounter any difficulties using the .NET Agent you can check out our <a href="user_netfaq.html#trouble">Troubleshooting</a> resources.</p>

            </a>
    </div>
</div>





  
      

<div id="footer">
    Copyright &copy 2013-2015  <a href="https://www.contrastsecurity.com" target="new"> <img src="../../assets/images/Contrast-logo-transparent.png" width="80" height="26" data-toggle="tooltip" data-placement="top" title="Check out our website"></a>  Licensed under <a href="https://www.creativecommons.org/licenses/by-nc-sa/4.0/" target="new"> <span style="color: #56b4aa">Creative Commons (CC BY-NC-SA 4.0)</span></a>
</div>

      
  </div>
  

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/twitterbutton.js"></script>
    <script src="assets/js/externallink.js"></script>
    <!--Lightbox -->
    <script src="assets/css/lightbox/lightbox.js"></script>
    <!--
    <script src="assets/css/lightbox/lightbox-plus-jquery.js"></script>
    -->


  </body>
</html>
